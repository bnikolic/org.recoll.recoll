id: org.recoll.recoll
runtime: org.kde.Platform
runtime-version: 5.15-23.08
sdk: org.kde.Sdk
base: io.qt.qtwebkit.BaseApp
base-version: 5.15-23.08
command: recoll

finish-args:
  - --share=ipc
  - --socket=fallback-x11
  - --socket=wayland
  - --device=dri
  - --filesystem=home

cleanup-commands:
  - /app/cleanup-BaseApp.sh

modules:
  - name: xapian-core
    config-opts:
      - --disable-sse
      - --disable-backend-chert
      - --disable-backend-remote
      - --disable-documentation
    cleanup:
      - /bin/copydatabase
      - /bin/quest
      - /bin/simple*
      - /bin/xapian-*
      - /share/aclocal
      - /share/doc
      - /share/man
    sources:
      - type: archive
        url: https://oligarchy.co.uk/xapian/1.4.26/xapian-core-1.4.26.tar.xz
        sha256: 9e6a7903806966d16ce220b49377c9c8fad667c8f0ffcb23a3442946269363a7

  - name: chmlib
    cleanup:
      - /include
      - '*.a'
    sources:
      - type: archive
        url: http://www.jedrea.com/chmlib/chmlib-0.40.tar.bz2
        sha256: 3449d64b0cf71578b2c7e3ddc048d4af3661f44a83941ea074a7813f3a59ffa3
      - type: script
        commands:
          - autoreconf --install

  - name: recoll
    buildsystem: meson
    build-options:
      env:
        QMAKEPATH: /app/lib
    config-opts:
      - -Dsystemd=false
    sources:
      - type: archive
        url: https://recoll.org/recoll-1.40.3.tar.gz
        sha256: cb7d9ed9b95bc4527dc2ff67b3521970e65e4200cc0007139e26e107817703b4
